# Vercel部署检查清单 ✅

按照这个清单一步步操作，确保部署成功！

## 📋 部署前准备

- [ ] 已注册GitHub账号
- [ ] 已注册Vercel账号（用GitHub登录）
- [ ] 已注册MongoDB Atlas账号

## 🗂️ 第一步：GitHub准备

### 1. 创建GitHub仓库

- [ ] 访问 https://github.com/new
- [ ] 仓库名称：`portfolio-tracker`
- [ ] 设置为Public（或Private，Vercel都支持）
- [ ] **不要**勾选"Add README"
- [ ] 点击"Create repository"

### 2. 推送代码到GitHub

```bash
cd "/Users/shaojin/Library/CloudStorage/OneDrive-Personal/learn/tracker"

# 使用快速部署脚本
./deploy.sh

# 或手动操作：
git init
git add .
git commit -m "Initial commit for Vercel"
git remote add origin https://github.com/YOUR-USERNAME/portfolio-tracker.git
git branch -M main
git push -u origin main
```

- [ ] 代码已成功推送到GitHub
- [ ] 在GitHub仓库页面能看到所有文件

## 💾 第二步：MongoDB Atlas设置

### 1. 注册并创建集群

- [ ] 访问 https://www.mongodb.com/cloud/atlas/register
- [ ] 完成注册
- [ ] 点击"Build a Database"
- [ ] 选择**M0 Free**（永久免费）
- [ ] 区域选择：**AWS / us-east-1**（或离你最近的）
- [ ] 集群名称保持默认或改为`portfolio-tracker`
- [ ] 点击"Create"

### 2. 创建数据库用户

- [ ] 在"Security"→"Database Access"
- [ ] 点击"Add New Database User"
- [ ] Username: `portfolio_user`
- [ ] Password: 点击"Autogenerate Secure Password"并**复制保存**
- [ ] 权限选择：**Read and write to any database**
- [ ] 点击"Add User"

### 3. 设置网络访问

- [ ] 在"Security"→"Network Access"
- [ ] 点击"Add IP Address"
- [ ] 点击"Allow Access from Anywhere"
- [ ] IP地址会自动填入：`0.0.0.0/0`
- [ ] 点击"Confirm"

### 4. 获取连接字符串

- [ ] 点击"Connect"
- [ ] 选择"Connect your application"
- [ ] Driver选择：**Python**
- [ ] Version选择：**3.6 or later**
- [ ] 复制连接字符串，类似：
  ```
  mongodb+srv://portfolio_user:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
  ```
- [ ] **重要**：将`<password>`替换为刚才保存的密码
- [ ] 保存完整的连接字符串（下一步会用到）

## 🚀 第三步：Vercel部署

### 1. 登录Vercel

- [ ] 访问 https://vercel.com
- [ ] 点击"Sign Up"或"Log In"
- [ ] 选择"Continue with GitHub"
- [ ] 授权Vercel访问你的GitHub

### 2. 导入项目

- [ ] 在Vercel Dashboard点击"Add New..."
- [ ] 选择"Project"
- [ ] 找到你的仓库`portfolio-tracker`
- [ ] 点击"Import"

### 3. 配置项目

#### Framework Preset
- [ ] Vercel会自动检测，保持默认即可

#### Build and Output Settings
- [ ] 保持默认，不需要修改

#### Environment Variables（重要！）
- [ ] 点击"Environment Variables"展开
- [ ] 添加变量：
  - Name: `MONGODB_URI`
  - Value: 粘贴你的MongoDB连接字符串
  - Environment: 全选（Production, Preview, Development）
- [ ] 点击"Add"

### 4. 部署

- [ ] 确认所有设置正确
- [ ] 点击"Deploy"
- [ ] 等待3-5分钟（首次部署会慢一些）

### 5. 验证部署

- [ ] 部署成功后会显示祝贺页面
- [ ] 复制你的网址，例如：`https://portfolio-tracker-abc123.vercel.app`
- [ ] 点击"Visit"或直接访问网址

## ✅ 第四步：测试功能

### 1. 基本功能测试

- [ ] 网站能正常打开
- [ ] 页面样式正常显示
- [ ] 没有明显错误

### 2. API测试

在浏览器中测试这些API：

- [ ] 健康检查：`https://你的域名/api/health`
  - 应该返回：`{"status": "ok", ...}`

- [ ] 股价查询：`https://你的域名/api/price/AAPL`
  - 应该返回苹果股票的价格

### 3. 云端同步测试

- [ ] 添加一个股票持仓
- [ ] 打开浏览器开发者工具（F12）
- [ ] 查看Console，应该看到：
  ```
  正在保存到云端...
  ✅ 数据已保存到云端
  ```

### 4. 多端同步测试

- [ ] 在电脑上添加持仓
- [ ] 在手机浏览器打开同一网址
- [ ] 应该能看到相同的数据

## 🐛 如果遇到问题

### API返回500错误

- [ ] 检查Vercel项目设置→Environment Variables
- [ ] 确认MONGODB_URI已正确配置
- [ ] 检查MongoDB密码中的特殊字符是否需要URL编码
- [ ] 查看Vercel项目日志（Dashboard→你的项目→Logs）

### 无法连接MongoDB

- [ ] 确认MongoDB网络访问设置为`0.0.0.0/0`
- [ ] 确认数据库用户已创建且密码正确
- [ ] 在连接字符串中检查密码格式

### 股价获取缓慢

- [ ] 这是正常的Serverless冷启动
- [ ] 首次访问会慢，后续会快
- [ ] 等待10-15秒

## 📱 第五步：分享使用

现在你可以：

- [ ] 在任何设备访问你的网址
- [ ] 添加到手机主屏幕（像App一样使用）
- [ ] 分享给朋友

### 添加到主屏幕（手机）

**iPhone:**
1. Safari打开你的网址
2. 点击底部分享按钮
3. 选择"添加到主屏幕"

**Android:**
1. Chrome打开你的网址
2. 点击菜单（三个点）
3. 选择"添加到主屏幕"

## 🎉 完成！

恭喜！你的股票追踪器已成功部署到云端！

现在你拥有：
- ✅ 一个完全免费的云端应用
- ✅ 支持多设备同步
- ✅ 使用真实股票数据
- ✅ 随时随地访问

## 📊 后续优化

部署成功后，你可以：

- [ ] 配置自定义域名
- [ ] 添加更多功能
- [ ] 优化性能
- [ ] 添加用户认证

详见 [Vercel部署指南.md](Vercel部署指南.md) 的优化建议部分。

---

**需要帮助？** 查看 [Vercel部署指南.md](Vercel部署指南.md) 的故障排查部分
